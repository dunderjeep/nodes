<dom-module id="graph-view">

  <template>
    <style>
         .flex
   {
	 display: flex;
	 flex-direction: column;
	 align-items: center;
	 justify-content: center;
	 }
    </style>
      <div class="flex">
    <h1>Nodes</h1>
    <div id="svg"></div>
    <h1>Nodes2</h1>
    <div id="svg2"></div>
    </div>
  </template>
  <script>
    function Graph(id) {
      var _id = id;
      var addNode = function(id) {
        console.log('chacha', _id);
      };
      var _graph =  d3.select(id)
          .append("svg")
          .attr("width", 500)
          .attr("height", 500)
          .attr("style", "outline: thin solid red;")
   
    

      return {
         addNode: addNode
      };
    };
    
    function point() {
      var _point = {
        that : {}
       };
       return _point;
    };
    Polymer({
      is: 'graph-view',
      properties: {  
        nodes: {
    type: Array
    }
    },
    observers: ['_nodesChanged(nodes.splices)'],
    _nodesChanged: function() {

        var circles = this.svg.selectAll("circle")
           .data(this.nodes);

    console.log(this.nodes);
    circles.enter().append("circle");
    circles.exit().remove("circle");    

    var circleAttributes = circles
                  .attr("cx", function (d) { return d.x; })
                  .attr("cy", function (d) { return d.y; })
                  .attr("r", 1)
                  .style("fill", "black");

    },
      
    ready: function() {

    var _graph = Graph(this.$.svg2);
    _graph.addNode();
    var _point = point();
    _point.that = this;

      this.svg =  d3.select(this.$.svg)
          .append("svg")
          .attr("width", 500)
          .attr("height", 500)
          .attr("style", "outline: thin solid red;")
    .on('click', function() {
           var point = d3.mouse(this);
           _point.that.push('nodes', {x: point[0], y: point[1]});
           console.log('e', this, _point);
           });   
    }
    });
  </script>
</dom-module>
